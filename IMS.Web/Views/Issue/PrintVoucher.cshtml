@using IMS.Application.DTOs
@model IssueVoucherDto
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>প্রাপ্তি বিলি ও ব্যয়ের রশিদ - @Model.VoucherNumber</title>
    <style>
        @@page {
            size: A4;
            margin: 20mm;
        }

        body {
            font-family: 'Noto Sans Bengali', 'SolaimanLipi', 'Kalpurush', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            font-size: 14px;
            line-height: 1.4;
        }

        .voucher-title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .top-section {
            display: table;
            width: 100%;
            border: 1px solid #000;
            margin-bottom: 20px;
        }

        .top-row {
            display: table-row;
        }

        .top-cell {
            display: table-cell;
            width: 50%;
            border: 1px solid #000;
            padding: 10px;
            vertical-align: top;
        }

        .top-cell-header {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .field-line {
            margin-bottom: 5px;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .items-table th,
        .items-table td {
            border: 1px solid #000;
            padding: 6px 4px;
            text-align: center;
            font-size: 13px;
        }

        .items-table th {
            font-weight: bold;
            background-color: #fff;
        }

        .items-table td.text-left {
            text-align: left;
        }

        .items-table td.text-right {
            text-align: right;
        }

        .signature-section {
            display: table;
            width: 100%;
            margin-top: 40px;
        }

        .signature-row {
            display: table-row;
        }

        .signature-cell {
            display: table-cell;
            width: 50%;
            padding: 20px;
            vertical-align: top;
        }

        .signature-label {
            font-weight: bold;
            margin-bottom: 60px;
        }

        .signature-field {
            margin-top: 5px;
        }

        @@media print {
            .no-print {
                display: none !important;
            }

            body {
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Title -->
    <div class="voucher-title">
        প্রাপ্তি বিলি ও ব্যয়ের রশিদ
    </div>

    <!-- Top Section - Two Columns -->
    <div class="top-section">
        <div class="top-row">
            <!-- Left Column - Provider Officer -->
            <div class="top-cell">
                <div class="top-cell-header">প্রদানকারী অফিসার পূরণ করবেন:</div>
                <div class="field-line">প্রদান- ভাউচার নং: @Model.VoucherNumber</div>
                <div class="field-line">ইউনিট: @(Model.IssuedTo ?? "...........................................")</div>
                <div class="field-line">স্টেশন: ............................................</div>
                <div class="field-line" style="margin-top: 15px;">
                    .................আদেশানুসারে .................. কর্তৃক<br />
                    .................কর্তৃক পরীক্ষানুযায়ী দ্রব্যাদির নিম্নোক্ত হিসাব :
                </div>
            </div>

            <!-- Right Column - Receiver Officer -->
            <div class="top-cell">
                <div class="top-cell-header">গ্রহনকারী অফিসার পূরণ করবেন:</div>
                <div class="field-line">প্রাপ্ত- ভাউচার নং: @Model.VoucherNumber</div>
                <div class="field-line">ইউনিট: ............................................</div>
                <div class="field-line">স্টেশন: ............................................</div>
                <div class="field-line" style="margin-top: 15px;">
                    <strong>প্রাপ্ত দ্রব্যাদির হিসাব নিম্নে দেওয়া হল:</strong><br />
                    <strong>উৎপাদির্</strong>
                </div>
            </div>
        </div>
    </div>

    <!-- Items Table -->
    <table class="items-table">
        <thead>
            <tr>
                <th style="width: 5%;">ক্রম</th>
                <th style="width: 8%;">লেজার<br />নং</th>
                <th style="width: 6%;">পৃষ্ঠা<br />নং</th>
                <th style="width: 22%;">দ্রব্যাদির বিবরণ</th>
                <th style="width: 8%;">মোট<br />সংখ্যা</th>
                <th style="width: 10%;">ব্যবহার<br />যোগ্য</th>
                <th style="width: 10%;">আংশিক<br />ব্যবহারযোগ্য</th>
                <th style="width: 8%;">অকেজো</th>
                <th style="width: 10%;">একক<br />দর</th>
                <th style="width: 13%;">মোট<br />মূল্য</th>
            </tr>
        </thead>
        <tbody>
            @{
                var serialNo = 1;
                foreach (var item in Model.Items)
                {
                    var totalPrice = (item.UnitPrice ?? 0) * item.Quantity;
                    <tr>
                        <td>@(serialNo++)</td>
                        <td>@(item.LedgerNo ?? "")</td>
                        <td>@(item.PageNo ?? "")</td>
                        <td class="text-left">@item.ItemName</td>
                        <td class="text-right">@item.Quantity.ToString("0.##")</td>
                        <td class="text-right">@(item.UsableQuantity?.ToString("0.##") ?? "")</td>
                        <td class="text-right">@(item.PartiallyUsableQuantity?.ToString("0.##") ?? "")</td>
                        <td class="text-right">@(item.UnusableQuantity?.ToString("0.##") ?? "")</td>
                        <td class="text-right">@((item.UnitPrice ?? 0).ToString("0.##"))</td>
                        <td class="text-right">@totalPrice.ToString("0.##")</td>
                    </tr>
                }

                @* Add empty rows to fill the table *@
                @for (int i = Model.Items.Count; i < 12; i++)
                {
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
                }
            }
        </tbody>
    </table>

    <!-- Signature Section -->
    <div class="signature-section">
        <div class="signature-row">
            <!-- Left - Provider Signature -->
            <div class="signature-cell">
                <div class="signature-label">বিতরণকারীর স্বাক্ষর</div>
                <div class="signature-field">পদবী ………………………………………………</div>
                <div class="signature-field">তারিখ…………………………………………………</div>
            </div>

            <!-- Right - Receiver Signature -->
            <div class="signature-cell">
                <div class="signature-label">গ্রহণকারীর স্বাক্ষর</div>
                <div class="signature-field">পদবী ………………………………………………</div>
                <div class="signature-field">তারিখ…………………………………………………</div>
            </div>
        </div>
    </div>

    <!-- Print Buttons -->
    <div class="no-print" style="text-align: center; margin-top: 30px;">
        <button onclick="window.print()" style="padding: 10px 20px; margin: 5px; font-size: 14px; cursor: pointer; background-color: #007bff; color: white; border: none; border-radius: 5px;">
            <i class="fas fa-print"></i> মুদ্রণ করুন
        </button>
        <button onclick="window.close()" style="padding: 10px 20px; margin: 5px; font-size: 14px; cursor: pointer; background-color: #6c757d; color: white; border: none; border-radius: 5px;">
            <i class="fas fa-times"></i> বন্ধ করুন
        </button>
    </div>
</body>
</html>
