@model IMS.Application.DTOs.AllotmentLetterDto
@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶™‡¶§‡ßç‡¶∞ - @Model.AllotmentNo</title>
    <style>
        @@media print {
            .no-print { display: none; }
            @@page {
                size: A4;
                margin: 20mm;
            }
        }

        body {
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            font-size: 14px;
            line-height: 1.6;
        }

        .page {
            background: white;
            padding: 30px;
            max-width: 210mm;
            margin: 0 auto;
        }

        /* Header Styles */
        .header {
            text-align: center;
            border-bottom: 3px double #000;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .header h1 {
            margin: 5px 0;
            font-size: 18px;
            font-weight: bold;
        }

        .header h2 {
            margin: 3px 0;
            font-size: 16px;
            font-weight: bold;
        }

        .header p {
            margin: 2px 0;
            font-size: 13px;
        }

        .header .website {
            color: #0066cc;
            text-decoration: underline;
        }

        /* Memo & Date */
        .memo-section {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            font-size: 13px;
        }

        .memo-no {
            font-weight: bold;
        }

        .date {
            font-weight: bold;
        }

        /* Subject */
        .subject {
            margin: 20px 0;
            text-align: left;
        }

        .subject-label {
            font-weight: bold;
            text-decoration: underline;
        }

        /* Body Text */
        .body-text {
            text-align: justify;
            margin: 15px 0;
            padding: 0 10px;
        }

        .body-text p {
            margin: 10px 0;
            text-indent: 30px;
        }

        .instruction-number {
            font-weight: bold;
            margin-right: 5px;
        }

        /* Recipients Section */
        .recipients-section {
            margin: 20px 0;
        }

        .recipient-item {
            margin: 5px 0 5px 30px;
        }

        /* Copy Distribution */
        .copy-distribution {
            margin-top: 30px;
            page-break-before: avoid;
        }

        .copy-distribution h3 {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .copy-item {
            margin: 5px 0;
            padding-left: 20px;
        }

        /* Signature */
        .signature-section {
            margin-top: 40px;
            text-align: right;
        }

        .signature-box {
            display: inline-block;
            text-align: center;
            min-width: 200px;
        }

        .signature-name {
            font-weight: bold;
            margin: 5px 0;
        }

        .signature-designation {
            margin: 3px 0;
        }

        .signature-contact {
            font-size: 12px;
            margin: 2px 0;
        }

        /* Attachment Table */
        .attachment-section {
            page-break-before: always;
            margin-top: 20px;
        }

        .attachment-header {
            text-align: right;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .attachment-title {
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            margin: 20px 0;
            text-decoration: underline;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 13px;
        }

        table, th, td {
            border: 1px solid #000;
        }

        th {
            background-color: #f0f0f0;
            padding: 8px;
            text-align: center;
            font-weight: bold;
        }

        td {
            padding: 6px 8px;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        tfoot td {
            font-weight: bold;
        }

        /* Print Button */
        .print-btn {
            margin: 20px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 4px;
        }

        .print-btn:hover {
            background-color: #0056b3;
        }

        .attachment-memo {
            margin-top: 15px;
            font-size: 12px;
        }

        .date-bengali {
            text-align: right;
            margin: 10px 0;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="no-print">
        <button class="print-btn" onclick="window.print()">
            üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
        <button class="print-btn" onclick="window.close()" style="background-color: #6c757d;">
            ‚úñ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
    </div>

    <!-- PAGE 1: Main Letter -->
    <div class="page">
        <!-- Header -->
        <div class="header">
            <h1>‡¶ó‡¶£‡¶™‡ßç‡¶∞‡¶ú‡¶æ‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßÄ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞</h1>
            <h2>‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø</h2>
            <p>‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§</p>
            <p class="website">www.ansarvdp.gov.bd</p>
        </div>

        <!-- Memo Number and Date -->
        <div class="memo-section">
            <div class="memo-no">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç- @Model.ReferenceNo</div>
            <div class="date">
                ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: @Model.AllotmentDate.ToString("dd/MM/yyyy")<br />
                @if (!string.IsNullOrEmpty(Model.BengaliDate))
                {
                    <span>@Model.BengaliDate</span>
                }
            </div>
        </div>

        <hr style="border: 1px solid #000; margin: 10px 0;" />

        <!-- Subject -->
        <div class="subject">
            <span class="subject-label">‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º :</span>
            @(Model.SubjectBn ?? Model.Subject ?? "‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡ßá")
        </div>

        <!-- Body Text -->
        <div class="body-text">
            @if (!string.IsNullOrEmpty(Model.BodyTextBn))
            {
                @Html.Raw(Model.BodyTextBn.Replace("\n", "<br />"))
            }
            else
            {
                <p>
                    ‡¶â‡¶™‡¶∞‡ßç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶ï‡ßç‡¶∑‡¶ø‡¶§‡ßá ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ö‡¶¨‡¶ó‡¶§‡¶ø ‡¶ì ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ú‡¶æ‡¶®‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶Ø‡ßá,
                    ‡¶Ü‡¶Ø‡¶º‡¶∏‡ßç‡¶ï‡¶æ‡¶≤ ‡¶¨‡¶ø‡¶¨‡ßá‡¶ö‡¶®‡¶æ‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶Ø‡¶§‡¶æ‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ '‡¶ï' ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
                </p>

                <p>
                    <span class="instruction-number">‡ß®‡•§</span>
                    ‡¶â‡¶™‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï/‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï ‡¶∞‡ßá‡¶û‡ßç‡¶ú ‡¶ï‡¶∞‡ßç‡¶§‡ßÉ‡¶ï ‡¶ó‡¶†‡¶ø‡¶§ ‡¶ï‡¶Æ‡¶ø‡¶ü‡¶ø‡¶ï‡ßá ‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ‡¶™‡¶§‡ßç‡¶∞ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá
                    @if (Model.CollectionDeadline.HasValue)
                    {
                        <strong>@Model.CollectionDeadline.Value.ToString("dd/MM/yyyy")</strong>
                    }
                    else
                    {
                        <strong>‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶ø‡¶§</strong>
                    }
                    ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞ ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶ï ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡ßÄ‡¶∏‡ßç‡¶• ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞/‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶π‡¶§‡ßá ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶ï‡ßÉ‡¶§
                    ‡¶â‡¶™‡¶ï‡¶∞‡¶£ ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®‡•§ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶®‡¶ø‡¶ú ‡¶®‡¶æ‡¶Æ‡ßÄ‡¶Ø‡¶º ‡¶∏‡ßÄ‡¶≤ ‡¶∏‡¶ô‡ßç‡¶ó‡ßá ‡¶Ü‡¶®‡¶¨‡ßá‡¶®‡•§
                </p>

                <p>
                    <span class="instruction-number">‡ß©‡•§</span>
                    ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶ï‡ßÉ‡¶§ ‡¶â‡¶™‡¶ï‡¶∞‡¶£ ‡¶™‡¶∞‡¶ø‡¶¨‡¶π‡¶®‡ßá‡¶∞ ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá ‡¶∞‡ßá‡¶û‡ßç‡¶ú‡ßá‡¶∞ ‡¶ó‡¶æ‡¶°‡¶º‡ßÄ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
                    ‡¶∞‡ßá‡¶û‡ßç‡¶ú‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶π‡¶® ‡¶¨‡ßç‡¶Ø‡¶§‡ßÄ‡¶§ ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶Ø‡¶æ‡¶®‡¶¨‡¶æ‡¶π‡¶® ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶π‡¶≤‡ßá ‡¶™‡ßç‡¶∞‡¶∂‡¶æ‡¶∏‡¶®-‡¶â‡¶á‡¶Ç ‡¶∂‡¶æ‡¶ñ‡¶æ‡¶Ø‡¶º ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
                </p>

                <p>
                    <span class="instruction-number">‡ß™‡•§</span>
                    ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶ï‡ßÉ‡¶§ ‡¶â‡¶™‡¶ï‡¶∞‡¶£‡ßá‡¶∞ ‡¶ú‡¶æ‡¶Æ‡¶æ‡¶®‡¶§ ‡¶Ö‡¶¨‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶®‡¶ø‡¶Æ‡¶ø‡¶§‡ßç‡¶§‡ßá ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞/‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶π‡¶§‡ßá
                    ‡¶â‡¶™‡¶ï‡¶∞‡¶£ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá‡¶∞ ‡ß©‡ß¶(‡¶§‡ßç‡¶∞‡¶ø‡¶∂) ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶∞ ‡¶ó‡ßÅ‡¶®‡¶ó‡¶§‡¶Æ‡¶æ‡¶® (‡¶Ü‡¶™‡¶§‡ßç‡¶§‡¶ø/‡¶Ö‡¶®‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶ø/‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø) ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡ßá‡¶¶‡¶®
                    (‡¶≤‡ßá‡¶ú‡¶æ‡¶∞‡¶≠‡ßÅ‡¶ï‡ßç‡¶§‡¶ø‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶Ø‡¶º‡¶®‡¶∏‡¶π) ‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶∂‡¶æ‡¶ñ‡¶æ‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡ßá‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
                </p>
            }
        </div>

        <p style="margin: 20px 0; padding-left: 10px;">
            ‡¶ï‡¶∞‡ßç‡¶§‡ßÉ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶®‡¶ï‡ßç‡¶∞‡¶Æ‡ßá ‡¶è ‡¶™‡¶§‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
        </p>

        <!-- Recipients List -->
        @if (Model.Recipients != null && Model.Recipients.Any())
        {
            <div class="recipients-section">
                @for (int i = 0; i < Model.Recipients.Count; i++)
                {
                    var recipient = Model.Recipients[i];
                    <div class="recipient-item">
                        @(i + 1)‡•§ @(recipient.RecipientType == "Range" ? "‡¶â‡¶™‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï" :
                        recipient.RecipientType == "Battalion" ? "‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï" :
                        recipient.RecipientType == "Zila" ? "‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï/‡¶ú‡ßá‡¶≤‡¶æ ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶®‡ßç‡¶ü" :
                        "‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶ï‡¶∞‡ßç‡¶Æ‡¶ï‡¶∞‡ßç‡¶§‡¶æ")
                        <br />
                        ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ
                        <br />
                        @(recipient.RecipientNameBn ?? recipient.RecipientName)
                        @if (!string.IsNullOrEmpty(recipient.Remarks))
                        {
                            <br /><em>@recipient.Remarks</em>
                        }
                    </div>
                }
            </div>
        }

        <!-- Attachment Note -->
        <div class="attachment-memo">
            ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§: ‡ß¶‡ßß (‡¶è‡¶ï) ‡¶™‡¶æ‡¶§‡¶æ
        </div>

        <!-- Signature Section -->
        <div class="signature-section">
            <div class="signature-box">
                <div class="signature-name">
                    @(Model.SignatoryName ?? "‡¶è.‡¶¨‡¶ø.‡¶è‡¶Æ. ‡¶´‡¶∞‡¶π‡¶æ‡¶¶, ‡¶¨‡¶ø‡¶¨‡¶ø‡¶è‡¶Æ")
                </div>
                <div class="signature-designation">
                    @if (!string.IsNullOrEmpty(Model.SignatoryId))
                    {
                        <span>@Model.SignatoryId</span><br />
                    }
                    @(Model.SignatoryDesignationBn ?? Model.SignatoryDesignation ?? "‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞)")
                </div>
                @if (!string.IsNullOrEmpty(Model.SignatoryEmail))
                {
                    <div class="signature-contact">‡¶á-‡¶Æ‡ßá‡¶á‡¶≤: @Model.SignatoryEmail</div>
                }
                @if (!string.IsNullOrEmpty(Model.SignatoryPhone))
                {
                    <div class="signature-contact">‡¶´‡ßã‡¶®: @Model.SignatoryPhone</div>
                }
                @if (!string.IsNullOrEmpty(Model.SignatoryPhone))
                {
                    <div class="signature-contact">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤: @Model.SignatoryPhone</div>
                }
            </div>
        </div>
    </div>

    <!-- PAGE 2: Copy Distribution -->
    <div class="page" style="page-break-before: always;">
        <!-- Copy Distribution Memo -->
        <div class="memo-section">
            <div class="memo-no">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç- @Model.ReferenceNo</div>
            <div class="date">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: @Model.AllotmentDate.ToString("dd/MM/yyyy")</div>
        </div>

        <!-- Copy Distribution List -->
        <div class="copy-distribution">
            <h3>‡¶Ö‡¶®‡ßÅ‡¶≤‡¶ø‡¶™‡¶ø‡¶É</h3>
            <div class="copy-item">
                ‡ßß‡•§ ‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï ‡¶Æ‡¶π‡ßã‡¶¶‡¶Ø‡¶º‡ßá‡¶∞ ‡¶∏‡¶ö‡¶ø‡¶¨‡¶æ‡¶≤‡¶Ø‡¶º<br />
                &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ, ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§
            </div>
            <div class="copy-item">
                ‡ß®‡•§ ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï ‡¶Æ‡¶π‡ßã‡¶¶‡¶Ø‡¶º‡ßá‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞<br />
                &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ, ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ö‡¶¨‡¶ó‡¶§‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§
            </div>
            <div class="copy-item">
                ‡ß©‡•§ ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶®‡ßç‡¶ü<br />
                &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞-‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡ßÄ, ‡¶∏‡¶´‡¶ø‡¶™‡ßÅ‡¶∞, ‡¶ó‡¶æ‡¶ú‡ßÄ‡¶™‡ßÅ‡¶∞‡•§
            </div>
            <div class="copy-item">
                ‡ß™‡•§ ‡¶â‡¶™‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶™‡ßç‡¶∞‡¶∂‡¶æ‡¶∏‡¶®/‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶∂‡¶®‡¶∏‡ßç/‡¶™‡ßç‡¶∞‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶£)<br />
                &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ, ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§
            </div>
            <div class="copy-item">
                ‡ß´‡•§ ‡¶â‡¶™‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï/‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï<br />
                &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ<br />
                &nbsp;&nbsp;&nbsp;&nbsp;(‡¶∏‡¶Ç‡¶∂‡ßç‡¶≤‡¶ø‡¶∑‡ßç‡¶ü ‡¶∞‡ßá‡¶û‡ßç‡¶ú)‡•§ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ö‡¶¨‡¶ó‡¶§‡¶ø ‡¶ì ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§
            </div>
            <div class="copy-item">
                ‡ß¨‡•§ ‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï<br />
                &nbsp;&nbsp;&nbsp;&nbsp;‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞/‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞<br />
                &nbsp;&nbsp;&nbsp;&nbsp;‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞-‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡ßÄ, ‡¶∏‡¶´‡¶ø‡¶™‡ßÅ‡¶∞, ‡¶ó‡¶æ‡¶ú‡ßÄ‡¶™‡ßÅ‡¶∞‡•§ ‡¶Ö‡¶¨‡¶ó‡¶§‡¶ø ‡¶ì ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§
            </div>
            <div class="copy-item">
                ‡ß≠‡•§ ‡¶ï‡ßã‡¶Ø‡¶º‡¶æ‡¶ü‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞<br />
                &nbsp;&nbsp;&nbsp;&nbsp;‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶∂‡¶æ‡¶ñ‡¶æ, ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§
            </div>
            <div class="copy-item">
                ‡ßÆ‡•§ ‡¶¶‡¶™‡ßç‡¶§‡¶∞/‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶™‡¶ø‡•§
            </div>
        </div>

        <div class="signature-section" style="margin-top: 40px;">
            <div class="signature-designation">
                @(Model.SignatoryDesignationBn ?? "‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞)")
            </div>
        </div>
    </div>

    <!-- PAGE 2: Attachment Table -->
    <div class="page attachment-section">
        <div class="attachment-header">
            ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ‡¶™‡¶§‡ßç‡¶∞-'‡¶ï'
        </div>

        <div class="memo-section">
            <div class="memo-no">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç- @Model.ReferenceNo</div>
            <div class="date">
                ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: @Model.AllotmentDate.ToString("dd/MM/yyyy")<br />
                @if (!string.IsNullOrEmpty(Model.BengaliDate))
                {
                    <span>@Model.BengaliDate</span>
                }
            </div>
        </div>

        <hr style="border: 1px solid #000; margin: 10px 0;" />

        <div class="attachment-title">
            @(Model.SubjectBn ?? Model.Subject ?? "‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡ßá‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶ì ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£")
        </div>

        <!-- Allotment Table with Recipients as Rows and Items as Columns -->
        <table>
            <thead>
                <tr>
                    <th rowspan="2" style="width: 50px;">‡¶ï‡ßç‡¶∞‡¶Æ</th>
                    <th rowspan="2" style="width: 200px;">‡¶á‡¶â‡¶®‡¶ø‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th>
                    @if (Model.Recipients.Any(r => !string.IsNullOrEmpty(r.StaffStrength)))
                    {
                        <th rowspan="2" style="width: 80px;">‡¶ï‡¶∞‡ßç‡¶Æ‡¶∞‡¶§<br />‡¶ú‡¶®‡¶¨‡¶≤</th>
                    }
                    <th rowspan="2" style="width: 60px;">‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡ßá‡¶∞<br />‡¶è‡¶ï‡¶ï</th>
                    <th colspan="@Model.Items.Count" class="text-center">‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th>
                    <th rowspan="2" style="width: 100px;">‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø</th>
                </tr>
                <tr>
                    @foreach (var item in Model.Items.OrderBy(i => i.Id))
                    {
                        <th style="width: 80px;">
                            @(item.ItemNameBn ?? item.ItemName)
                        </th>
                    }
                </tr>
            </thead>
            <tbody>
                @if (Model.Recipients != null && Model.Recipients.Any())
                {
                    @for (int i = 0; i < Model.Recipients.Count; i++)
                    {
                        var recipient = Model.Recipients[i];
                        <tr>
                            <td class="text-center">@(i + 1)</td>
                            <td>@(recipient.RecipientNameBn ?? recipient.RecipientName)</td>
                            @if (Model.Recipients.Any(r => !string.IsNullOrEmpty(r.StaffStrength)))
                            {
                                <td class="text-center">@(recipient.StaffStrength ?? "")</td>
                            }
                            <td class="text-center">
                                @if (recipient.Items.Any())
                                {
                                    @(recipient.Items.First().UnitBn ?? recipient.Items.First().Unit ?? "‡¶ü‡¶ø")
                                }
                                else
                                {
                                    <span>‡¶ü‡¶ø</span>
                                }
                            </td>
                            @foreach (var headerItem in Model.Items.OrderBy(i => i.Id))
                            {
                                var recipientItem = recipient.Items.FirstOrDefault(ri => ri.ItemId == headerItem.ItemId);
                                <td class="text-center">
                                    @if (recipientItem != null && recipientItem.AllottedQuantity > 0)
                                    {
                                        @recipientItem.AllottedQuantity.ToString("0")
                                    }
                                    else
                                    {
                                        <span>--</span>
                                    }
                                </td>
                            }
                            <td>@(recipient.Remarks ?? "")</td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="100" class="text-center">‡¶ï‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶æ‡¶™‡¶ï ‡¶®‡ßá‡¶á</td>
                    </tr>
                }
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="@(Model.Recipients.Any(r => !string.IsNullOrEmpty(r.StaffStrength)) ? 4 : 3)" class="text-right">
                        ‡¶Æ‡ßã‡¶ü=
                    </td>
                    @foreach (var item in Model.Items.OrderBy(i => i.Id))
                    {
                        var total = Model.Recipients.SelectMany(r => r.Items).Where(ri => ri.ItemId == item.ItemId).Sum(ri => ri.AllottedQuantity);
                        <td class="text-center">@total.ToString("0")</td>
                    }
                    <td></td>
                </tr>
            </tfoot>
        </table>

        <div class="date-bengali">
            @if (!string.IsNullOrEmpty(Model.BengaliDate))
            {
                @Model.BengaliDate
            }
        </div>

        <div class="signature-section" style="margin-top: 40px;">
            <div class="signature-box">
                <div class="signature-name">
                    @(Model.SignatoryName ?? "‡¶è.‡¶¨‡¶ø.‡¶è‡¶Æ. ‡¶´‡¶∞‡¶π‡¶æ‡¶¶, ‡¶¨‡¶ø‡¶¨‡¶ø‡¶è‡¶Æ")
                </div>
                <div class="signature-designation">
                    @if (!string.IsNullOrEmpty(Model.SignatoryId))
                    {
                        <span>@Model.SignatoryId</span><br />
                    }
                    @(Model.SignatoryDesignationBn ?? "‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞)")
                </div>
            </div>
        </div>
    </div>

    <script>
        // Auto-print on load (optional)
        // window.onload = function() { window.print(); }
    </script>
</body>
</html>
