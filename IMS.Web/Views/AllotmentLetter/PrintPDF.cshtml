@using IMS.Application.Helpers
@model IMS.Application.DTOs.AllotmentLetterDto
@{
    Layout = null;
    var fileName = $"Allotment_{Model.AllotmentNo}_{DateTime.Now:yyyyMMdd}.pdf";

    // Get Bengali formatted dates
    var (bengaliCalendarDate, gregorianBengaliDate) = BengaliDateHelper.GetBothFormats(Model.AllotmentDate);
}

<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶™‡¶§‡ßç‡¶∞ - @Model.AllotmentNo</title>
    <style>
        @@media print {
            .no-print { display: none !important; }
            @@page {
                size: A4;
                margin: 20mm 15mm;
            }
            body { margin: 0; padding: 0; }
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Kalpurush', 'SolaimanLipi', 'Noto Sans Bengali', 'Nikosh', Arial, sans-serif;
            font-size: 12pt;
            line-height: 1.6;
            background: white;
            color: #000;
        }

        .page-container {
            max-width: 210mm;
            margin: 0 auto;
            background: white;
        }

        /* ========== HEADER ========== */
        .header {
            text-align: center;
            margin-bottom: 10px;
        }

        .header h1 {
            font-size: 14pt;
            font-weight: bold;
            margin: 2px 0;
            line-height: 1.2;
        }

        .header h2 {
            font-size: 13pt;
            font-weight: bold;
            margin: 2px 0;
        }

        .header p {
            font-size: 11pt;
            margin: 1px 0;
        }

        .header .website {
            color: #0066cc;
            font-size: 10pt;
        }

        /* ========== MEMO & DATE (Single Line) ========== */
        .memo-date-line {
            margin: 15px 0 8px 0;
            font-size: 11pt;
            font-weight: bold;
        }

        .divider-dashes {
            margin: 5px 0;
            text-align: left;
        }

        /* ========== SUBJECT ========== */
        .subject-section {
            margin: 12px 0;
            font-size: 12pt;
        }

        .subject-label {
            font-weight: bold;
            text-decoration: underline;
        }

        /* ========== BODY CONTENT ========== */
        .body-content {
            margin: 12px 0;
            text-align: justify;
            font-size: 12pt;
            line-height: 1.7;
        }

        .body-content p {
            margin: 10px 0;
            text-indent: 0;
        }

        /* ========== RECIPIENTS LIST ========== */
        .recipients-list {
            margin: 15px 0;
            font-size: 12pt;
            line-height: 1.6;
        }

        .recipient-item {
            margin: 8px 0 12px 0;
        }

        .recipient-number {
            font-weight: bold;
        }

        .recipient-line1 {
            margin-left: 25px;
        }

        .recipient-line2 {
            margin-left: 25px;
        }

        .recipient-line3 {
            margin-left: 25px;
        }

        /* ========== CLOSING TEXT ========== */
        .closing-text {
            margin: 15px 0;
            text-align: left;
            font-size: 12pt;
        }

        /* ========== SIGNATURE ========== */
        .signature-section {
            margin-top: 30px;
            text-align: right;
        }

        .signature-box {
            display: inline-block;
            text-align: center;
            min-width: 220px;
        }

        .signatory-name {
            font-weight: bold;
            font-size: 12pt;
            margin: 2px 0;
        }

        .signatory-id {
            font-size: 11pt;
            margin: 1px 0;
        }

        .signatory-designation {
            font-size: 12pt;
            margin: 2px 0;
        }

        .signatory-contact {
            font-size: 10pt;
            margin: 1px 0;
        }

        /* ========== DISTRIBUTION LIST ========== */
        .distribution-section {
            page-break-before: always;
            margin-top: 0;
        }

        .distribution-title {
            font-weight: bold;
            margin: 12px 0 10px 0;
            font-size: 12pt;
        }

        .distribution-list {
            list-style: none;
            font-size: 11pt;
            line-height: 1.8;
        }

        .distribution-list li {
            margin: 6px 0;
            text-align: justify;
        }

        /* ========== DATES (Bengali) ========== */
        .bengali-dates {
            text-align: right;
            font-size: 11pt;
            margin-top: 15px;
            line-height: 1.4;
        }

        /* ========== ATTACHMENT FOOTER ========== */
        .attachment-footer {
            margin-top: 15px;
            font-size: 11pt;
            font-weight: bold;
        }

        /* ========== ANNEXURE ========== */
        .annexure-section {
            page-break-before: always;
            margin-top: 0;
            position: relative;
        }

        .annexure-heading {
            text-align: right;
            font-weight: bold;
            font-size: 12pt;
            margin: 5px 0 15px 0;
            text-decoration: underline;
        }

        .annexure-subtitle {
            text-align: center;
            font-weight: bold;
            font-size: 12pt;
            margin: 12px 0;
        }

        /* ========== TABLE ========== */
        .annexure-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 10pt;
        }

        .annexure-table th,
        .annexure-table td {
            border: 1px solid #000;
            padding: 5px 4px;
            text-align: center;
            vertical-align: middle;
        }

        .annexure-table th {
            background-color: #f0f0f0;
            font-weight: bold;
            font-size: 9pt;
            line-height: 1.3;
        }

        .annexure-table td.text-left {
            text-align: left;
            padding-left: 6px;
        }

        .annexure-table tfoot td {
            font-weight: bold;
            background-color: #f8f8f8;
        }

        /* ========== PRINT BUTTON ========== */
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #006a4e;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .print-button:hover {
            background: #004d38;
        }

        @@media print {
            .print-button { display: none !important; }
        }
    </style>

    <!-- html2pdf.js library for PDF download -->
    <script src="~/lib/html2pdf/html2pdf.bundle.min.js"></script>
</head>
<body>
    <button class="print-button no-print" onclick="downloadPDF()">
        üì• Download PDF
    </button>

    <div class="page-container">
        <!-- ========================= PAGE 1: MAIN LETTER ========================= -->

        <!-- ========== HEADER ========== -->
        <div class="header">
            <h1>‡¶ó‡¶£‡¶™‡ßç‡¶∞‡¶ú‡¶æ‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßÄ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞</h1>
            <h2>‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ</h2>
            <p>‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§</p>
            <p class="website">www.ansarvdp.gov.bd</p>
        </div>

        <!-- ========== MEMO & DATE (Single Line with spaces) ========== -->
        <div class="memo-date-line">
            ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç- @(Model.ReferenceNo ?? Model.AllotmentNo)
            <span style="float: right;">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: @gregorianBengaliDate</span>
        </div>
        <div style="clear: both;"></div>

        <div class="divider-dashes">--------</div>

        <!-- ========== SUBJECT ========== -->
        <div class="subject-section">
            <span class="subject-label">‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º</span> : @(Model.SubjectBn ?? Model.Subject ?? "‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡ßá")‡•§
        </div>

        <!-- ========== MAIN BODY ========== -->
        <div class="body-content">
            @if (!string.IsNullOrEmpty(Model.BodyTextBn))
            {
                @Html.Raw(Model.BodyTextBn.Replace("\n", "<br />"))
            }
            else
            {
                <p>
                    ‡¶â‡¶™‡¶∞‡ßã‡¶ï‡ßç‡¶§ ‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶ï‡ßç‡¶∑‡¶ø‡¶§‡ßá ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶¶‡¶™‡ßç‡¶§‡¶∞/‡¶á‡¶â‡¶®‡¶ø‡¶ü‡ßá‡¶∞ ‡¶ö‡¶æ‡¶π‡¶ø‡¶¶‡¶æ‡¶∞ ‡¶Ü‡¶≤‡ßã‡¶ï‡ßá ‡¶Ü‡¶Ø‡¶º‡ßÅ‡¶∑‡ßç‡¶ï‡¶æ‡¶≤ ‡¶¨‡¶ø‡¶¨‡ßá‡¶ö‡¶®‡¶æ‡¶Ø‡¶º
                    ‡¶ï‡ßç‡¶∞‡ßã‡¶°‡¶º‡¶™‡¶§‡ßç‡¶∞-"‡¶ï" ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ @(Model.SubjectBn ?? "‡¶â‡¶™‡¶ï‡¶∞‡¶£") ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
                </p>

                <p>
                    <strong>‡ß®‡•§</strong> ‡¶â‡¶™‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï/‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï ‡¶∞‡ßá‡¶û‡ßç‡¶ú ‡¶ï‡¶∞‡ßç‡¶§‡ßÉ‡¶ï ‡¶ó‡¶†‡¶ø‡¶§ ‡¶ï‡¶Æ‡¶ø‡¶ü‡¶ø‡¶ï‡ßá ‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ‡¶™‡¶§‡ßç‡¶∞ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá
                    ‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ <strong>@(Model.AllotmentDate.AddDays(30).ToString("dd/MM/yyyy"))</strong> ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá
                    ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞ ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶ï ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡¶ø‡¶∏‡ßç‡¶• ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞/‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶≠‡¶æ‡¶£‡ßç‡¶°‡¶æ‡¶∞ ‡¶π‡¶§‡ßá ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶ï‡ßÉ‡¶§
                    ‡¶â‡¶™‡¶ï‡¶∞‡¶£ ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®‡•§ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶®‡¶ø‡¶ú ‡¶®‡¶æ‡¶Æ‡ßÄ‡¶Ø‡¶º ‡¶∏‡ßÄ‡¶≤ ‡¶∏‡¶ô‡ßç‡¶ó‡ßá ‡¶Ü‡¶®‡¶¨‡ßá‡¶®‡•§
                </p>

                <p>
                    <strong>‡ß©‡•§</strong> ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶ï‡ßÉ‡¶§ @(Model.SubjectBn ?? "‡¶â‡¶™‡¶ï‡¶∞‡¶£") ‡¶è‡¶∞ ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü‡¶ø ‡¶•‡¶æ‡¶ï‡¶æ ‡¶∏‡¶æ‡¶™‡ßá‡¶ï‡ßç‡¶∑‡ßá
                    ‡¶∏‡¶∞‡¶¨‡¶∞‡¶æ‡¶π‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶® ‡¶â‡¶ï‡ßç‡¶§ ‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá ‡¶´‡ßç‡¶∞‡¶ø ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏‡¶ø‡¶Ç ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶¨‡¶ø‡¶ß‡¶æ‡¶Ø‡¶º ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶ï‡ßÉ‡¶§ ‡¶â‡¶™‡¶ï‡¶∞‡¶£‡ßá
                    ‡¶ï‡ßã‡¶® ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü‡¶ø ‡¶ï‡¶æ‡¶∞‡ßç‡¶°‡¶∏‡¶π ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞ ‡¶™‡ßç‡¶∞‡¶≠‡¶ø‡¶∂‡¶® ‡¶∂‡¶æ‡¶ñ‡¶æ‡¶Ø‡¶º ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
                    ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
                </p>

                <p>
                    <strong>‡ß™‡•§</strong> ‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞‡ßá ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡¶ï‡ßÉ‡¶§ ‡¶â‡¶™‡¶ï‡¶∞‡¶£‡ßá‡¶∞ ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ì ‡¶∏‡¶ø‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ ‡¶•‡¶æ‡¶ï‡¶¨‡ßá‡•§
                    ‡¶â‡¶ï‡ßç‡¶§ ‡¶â‡¶™‡¶ï‡¶∞‡¶£ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∏‡¶ø‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶Æ‡¶ø‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶®‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§ ‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡ßá
                    ‡¶â‡¶™‡¶ï‡¶∞‡¶£ ‡¶´‡ßá‡¶∞‡¶§/‡¶π‡¶∏‡ßç‡¶§‡¶æ‡¶®‡ßç‡¶§‡¶∞/‡¶Ö‡¶ï‡ßá‡¶ú‡ßã‡¶ï‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßá ‡¶â‡¶ï‡ßç‡¶§ ‡¶∏‡¶ø‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶ì ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
                </p>

                <p>
                    <strong>‡ß´‡•§</strong> ‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ‡ßç‡¶Ø, ‡¶™‡ßÅ‡¶∞‡¶æ‡¶§‡¶® @(Model.SubjectBn ?? "‡¶â‡¶™‡¶ï‡¶∞‡¶£") ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá
                    ‡¶Ö‡¶®‡ßÅ‡¶™‡¶Ø‡ßã‡¶ó‡ßÄ/‡¶Ö‡¶ï‡ßá‡¶ú‡ßã‡¶ï‡¶∞‡¶£‡ßá‡¶∞ ‡¶â‡¶™‡¶Ø‡ßã‡¶ó‡ßÄ ‡¶π‡¶≤‡ßá ‡¶∏‡ßá‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ì ‡¶∏‡¶ø‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶ï
                    ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞, ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞-‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡ßÄ‡¶§‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶®‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
                </p>
            }
        </div>

        <!-- ========== CLOSING TEXT ========== -->
        <div class="closing-text">
            ‡¶ï‡¶∞‡ßç‡¶§‡ßÉ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶®‡¶ï‡ßç‡¶∞‡¶Æ‡ßá ‡¶è ‡¶™‡¶§‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§
        </div>

        <!-- ========== RECIPIENTS LIST (with full 3-line addresses) ========== -->
        @if (Model.Recipients != null && Model.Recipients.Any())
        {
            <div class="recipients-list">
                @foreach (var recipient in Model.Recipients.OrderBy(r => r.SerialNo).Take(4))
                {
                    <div class="recipient-item">
                        <div><span class="recipient-number">@(recipient.SerialNo)‡•§</span>
                        ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï/‡¶Ö‡¶ß‡¶ø‡¶®‡¶æ‡¶Ø‡¶º‡¶ï
                        </div>
                        <div class="recipient-line1">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ</div>
                        <div class="recipient-line2">@(recipient.RecipientNameBn ?? recipient.RecipientName)‡•§</div>
                    </div>
                }
            </div>
        }
        else
        {
            <!-- Default recipient format when no specific recipients -->
            <div class="recipients-list" style="margin-top: 20px; margin-bottom: 15px;">
                <div style="font-size: 12pt; line-height: 1.6;">
                    <div style="margin-bottom: 8px;"><strong>‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï/‡¶Ö‡¶ß‡¶ø‡¶®‡¶æ‡¶Ø‡¶º‡¶ï</strong></div>
                    <div style="margin-left: 0px;">.....................‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡¶®(.........‡¶¨‡¶ø‡¶è‡¶®)</div>
                    <div style="margin-left: 0px;">.....................................................................</div>
                </div>
            </div>
        }

        <!-- ========== SIGNATURE ========== -->
        <div class="signature-section">
            <div class="signature-box">
                <div class="signatory-name">@(Model.SignatoryName ?? "‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ")</div>
                @if (!string.IsNullOrEmpty(Model.SignatoryId))
                {
                    <div class="signatory-id">@Model.SignatoryId</div>
                }
                <div class="signatory-designation">@(Model.SignatoryDesignationBn ?? Model.SignatoryDesignation ?? "‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶≠‡¶æ‡¶£‡ßç‡¶°‡¶æ‡¶∞)")</div>
                @if (!string.IsNullOrEmpty(Model.SignatoryEmail))
                {
                    <div class="signatory-contact">e-mail: @Model.SignatoryEmail</div>
                }
                @if (!string.IsNullOrEmpty(Model.SignatoryPhone))
                {
                    @if (Model.SignatoryPhone.Contains(","))
                    {
                        var phones = Model.SignatoryPhone.Split(',');
                        <div class="signatory-contact">‡¶´‡ßã‡¶® : @phones[0].Trim()</div>
                        <div class="signatory-contact">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤: @phones[1].Trim()</div>
                    }
                    else
                    {
                        <div class="signatory-contact">‡¶´‡ßã‡¶® : @Model.SignatoryPhone</div>
                    }
                }
            </div>
        </div>

        <!-- ========================= PAGE 2: DISTRIBUTION LIST ========================= -->
        <div class="distribution-section">
            <!-- Repeat Memo & Date -->
            <div class="memo-date-line">
                ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç- @(Model.ReferenceNo ?? Model.AllotmentNo)
                <span style="float: right;">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: @gregorianBengaliDate</span>
            </div>
            <div style="clear: both;"></div>

            <div class="distribution-title">‡¶Ö‡¶®‡ßÅ‡¶≤‡¶ø‡¶™‡¶ø:</div>

            @if (Model.DistributionList != null && Model.DistributionList.Any())
            {
                <ul class="distribution-list">
                    @foreach (var item in Model.DistributionList.OrderBy(d => d.DisplayOrder).ThenBy(d => d.SerialNo))
                    {
                        <li>
                            <strong>@BengaliDateHelper.ConvertToBengaliDigits(item.SerialNo)‡•§</strong>
                            @(item.RecipientTitleBn ?? item.RecipientTitle)
                            @if (!string.IsNullOrEmpty(item.AddressBn ?? item.Address))
                            {
                                <br />
                                <text>&nbsp;&nbsp;&nbsp;&nbsp;@(item.AddressBn ?? item.Address)</text>
                            }
                            @if (!string.IsNullOrEmpty(item.PurposeBn ?? item.Purpose))
                            {
                                <text> @(item.PurposeBn ?? item.Purpose)‡•§</text>
                            }
                        </li>
                    }
                </ul>
            }
            else
            {
                <!-- Default distribution list if none specified -->
                <ul class="distribution-list">
                    <li><strong>‡ßß‡•§</strong> ‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï ‡¶Æ‡¶π‡ßã‡¶¶‡¶Ø‡¶º‡ßá‡¶∞ ‡¶∏‡¶ö‡¶ø‡¶¨‡¶æ‡¶≤‡¶Ø‡¶º<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ, ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§</li>

                    <li><strong>‡ß®‡•§</strong> ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï ‡¶Æ‡¶π‡ßã‡¶¶‡¶Ø‡¶º‡ßá‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ, ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ö‡¶¨‡¶ó‡¶§‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</li>

                    <li><strong>‡ß©‡•§</strong> ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶®‡ßç‡¶ü<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞-‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡ßÄ, ‡¶∏‡¶´‡¶ø‡¶™‡ßÅ‡¶∞, ‡¶ó‡¶æ‡¶ú‡ßÄ‡¶™‡ßÅ‡¶∞‡•§</li>

                    <li><strong>‡ß™‡•§</strong> ‡¶â‡¶™‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶™‡ßç‡¶∞‡¶∂‡¶æ‡¶∏‡¶®/‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶∂‡¶®‡¶∏‡ßç/‡¶™‡ßç‡¶∞‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶£)<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ, ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§</li>

                    <li><strong>‡ß´‡•§</strong> ‡¶â‡¶™‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï/‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶π‡¶ø‡¶®‡ßÄ<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶(‡¶∏‡¶Ç‡¶∂‡ßç‡¶≤‡¶ø‡¶∑‡ßç‡¶ü ‡¶∞‡ßá‡¶û‡ßç‡¶ú)‡•§ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ö‡¶¨‡¶ó‡¶§‡¶ø ‡¶ì ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</li>

                    <li><strong>‡ß¨‡•§</strong> ‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßÄ‡¶Ø‡¶º ‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞/‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶≠‡¶æ‡¶£‡ßç‡¶°‡¶æ‡¶∞<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‡¶Ü‡¶®‡¶∏‡¶æ‡¶∞-‡¶≠‡¶ø‡¶°‡¶ø‡¶™‡¶ø ‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡ßÄ, ‡¶∏‡¶´‡¶ø‡¶™‡ßÅ‡¶∞, ‡¶ó‡¶æ‡¶ú‡ßÄ‡¶™‡ßÅ‡¶∞‡•§ ‡¶Ö‡¶¨‡¶ó‡¶§‡¶ø ‡¶ì ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</li>

                    <li><strong>‡ß≠‡•§</strong> ‡¶ï‡ßã‡¶Ø‡¶º‡¶æ‡¶ü‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞<br />
                        &nbsp;&nbsp;&nbsp;&nbsp;‡¶≠‡¶æ‡¶£‡ßç‡¶°‡¶æ‡¶∞ ‡¶∂‡¶æ‡¶ñ‡¶æ, ‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶™‡ßç‡¶§‡¶∞, ‡¶ñ‡¶ø‡¶≤‡¶ó‡¶æ‡¶Å‡¶ì, ‡¶¢‡¶æ‡¶ï‡¶æ‡•§</li>

                    <li><strong>‡ßÆ‡•§</strong> ‡¶¶‡¶™‡ßç‡¶§‡¶∞/‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶™‡¶ø- ‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶≠‡¶æ‡¶£‡ßç‡¶°‡¶æ‡¶∞)</li>
                </ul>
            }

            <div class="bengali-dates">
                <div>@bengaliCalendarDate</div>
                <div>@gregorianBengaliDate</div>
            </div>

            <div class="attachment-footer">
                ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§-‡¶ï‡ßç‡¶∞‡ßã‡¶°‡¶º‡¶™‡¶§‡ßç‡¶∞ "‡¶ï" ‡ß¶‡ßß (‡¶è‡¶ï) ‡¶™‡¶æ‡¶§‡¶æ‡•§
            </div>

            <!-- Signature on Page 2 (bottom right) -->
            <div class="signature-section" style="margin-top: 40px; text-align: right;">
                <div class="signature-box" style="display: inline-block; text-align: center; min-width: 200px;">
                    <div class="signatory-name">@(Model.SignatoryName ?? "‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ")</div>
                    @if (!string.IsNullOrEmpty(Model.SignatoryId))
                    {
                        <div class="signatory-id">@Model.SignatoryId</div>
                    }
                    <div class="signatory-designation">@(Model.SignatoryDesignationBn ?? Model.SignatoryDesignation ?? "‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶≠‡¶æ‡¶£‡ßç‡¶°‡¶æ‡¶∞)")</div>
                </div>
            </div>
        </div>

        <!-- ========================= PAGE 3: ANNEXURE TABLE ========================= -->
        @if (Model.Recipients != null && Model.Recipients.Any())
        {
            <div class="annexure-section">
                <div class="annexure-heading">‡¶ï‡ßç‡¶∞‡ßã‡¶°‡¶º‡¶™‡¶§‡ßç‡¶∞-'‡¶ï'</div>

                <div class="memo-date-line">
                    ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç- @(Model.ReferenceNo ?? Model.AllotmentNo)
                    <span style="float: right;">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: @gregorianBengaliDate</span>
                </div>
                <div style="clear: both;"></div>

                <div class="divider-dashes">--------</div>

                <div class="annexure-subtitle">
                    @(Model.SubjectBn ?? Model.Subject) ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡ßá‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶ì ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶®
                </div>

                <table class="annexure-table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">‡¶ï‡ßç‡¶∞‡¶Æ</th>
                            <th style="width: 250px;">‡¶á‡¶â‡¶®‡¶ø‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th>
                            <th style="width: 100px;">‡¶ï‡¶∞‡ßç‡¶§‡ßÉ‡¶§‡ßç‡¶¨<br />‡¶ú‡¶®‡¶¨‡¶≤</th>
                            <th style="width: 100px;">‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡ßá‡¶∞ ‡¶è‡¶ï‡¶ï</th>
                            <th style="width: 120px;">‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th>
                            <th style="width: 80px;">‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            decimal totalQuantity = 0;
                            var firstItem = Model.Items?.FirstOrDefault();
                        }
                        @foreach (var recipient in Model.Recipients.OrderBy(r => r.SerialNo))
                        {
                            var recipientQuantity = recipient.Items?.Sum(i => i.AllottedQuantity) ?? 0;
                            totalQuantity += recipientQuantity;
                            <tr>
                                <td style="text-align: center;">@recipient.SerialNo.</td>
                                <td class="text-left" style="padding-left: 8px;">@(recipient.RecipientNameBn ?? recipient.RecipientName)</td>
                                <td style="text-align: center;">@(recipient.StaffStrength ?? "")</td>
                                <td style="text-align: center;">@(firstItem?.UnitBn ?? firstItem?.Unit ?? "‡¶ü‡¶ø")</td>
                                <td style="text-align: center;">@(recipientQuantity > 0 ? recipientQuantity.ToString("0") : "")</td>
                                <td style="text-align: center; font-size: 9pt;">@(recipient.Remarks ?? "")</td>
                            </tr>
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4" style="text-align: right; padding-right: 10px; font-weight: bold;">‡¶Æ‡ßã‡¶ü=</td>
                            <td style="text-align: center; font-weight: bold;">@totalQuantity.ToString("0")</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>

                <!-- Signature on Page 3 (bottom right) -->
                <div class="signature-section" style="margin-top: 40px; text-align: right;">
                    <div class="signature-box" style="display: inline-block; text-align: center; min-width: 200px;">
                        <div class="signatory-name">@(Model.SignatoryName ?? "‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ")</div>
                        @if (!string.IsNullOrEmpty(Model.SignatoryId))
                        {
                            <div class="signatory-id">@Model.SignatoryId</div>
                        }
                        <div class="signatory-designation">@(Model.SignatoryDesignationBn ?? Model.SignatoryDesignation ?? "‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶≠‡¶æ‡¶£‡ßç‡¶°‡¶æ‡¶∞)")</div>
                    </div>
                </div>
            </div>
        }
        else if (Model.Items != null && Model.Items.Any())
        {
            <!-- Fallback: Show simple items table when there are no recipients -->
            <div class="annexure-section">
                <div class="annexure-heading">‡¶ï‡ßç‡¶∞‡ßã‡¶°‡¶º‡¶™‡¶§‡ßç‡¶∞-'‡¶ï'</div>

                <div class="memo-date-line">
                    ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï ‡¶®‡¶Ç- @(Model.ReferenceNo ?? Model.AllotmentNo)
                    <span style="float: right;">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: @gregorianBengaliDate</span>
                </div>
                <div style="clear: both;"></div>

                <div class="divider-dashes">--------</div>

                <div class="annexure-subtitle">
                    @(Model.SubjectBn ?? Model.Subject) ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡ßá‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶ì ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶®
                </div>

                <table class="annexure-table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">‡¶ï‡ßç‡¶∞‡¶Æ</th>
                            <th style="width: 350px;">‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th>
                            <th style="width: 100px;">‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡ßá‡¶∞ ‡¶è‡¶ï‡¶ï</th>
                            <th style="width: 120px;">‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th>
                            <th style="width: 100px;">‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            decimal totalQuantity = 0;
                            int serialNo = 1;
                        }
                        @foreach (var item in Model.Items)
                        {
                            totalQuantity += item.AllottedQuantity;
                            <tr>
                                <td style="text-align: center;">@(serialNo++).</td>
                                <td class="text-left" style="padding-left: 8px;">@(item.ItemNameBn ?? item.ItemName)</td>
                                <td style="text-align: center;">@(item.UnitBn ?? item.Unit ?? "‡¶ü‡¶ø")</td>
                                <td style="text-align: center;">@item.AllottedQuantity.ToString("0")</td>
                                <td style="text-align: center; font-size: 9pt;">@(item.Remarks ?? "")</td>
                            </tr>
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3" style="text-align: right; padding-right: 10px; font-weight: bold;">‡¶Æ‡ßã‡¶ü=</td>
                            <td style="text-align: center; font-weight: bold;">@totalQuantity.ToString("0")</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>

                <!-- Signature on Page 3 (bottom right) -->
                <div class="signature-section" style="margin-top: 40px; text-align: right;">
                    <div class="signature-box" style="display: inline-block; text-align: center; min-width: 200px;">
                        <div class="signatory-name">@(Model.SignatoryName ?? "‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ")</div>
                        @if (!string.IsNullOrEmpty(Model.SignatoryId))
                        {
                            <div class="signatory-id">@Model.SignatoryId</div>
                        }
                        <div class="signatory-designation">@(Model.SignatoryDesignationBn ?? Model.SignatoryDesignation ?? "‡¶â‡¶™‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶ï (‡¶≠‡¶æ‡¶£‡ßç‡¶°‡¶æ‡¶∞)")</div>
                    </div>
                </div>
            </div>
        }
    </div>

    <script>
        // Function to download PDF
        function downloadPDF() {
            const element = document.querySelector('.page-container');
            const fileName = '@fileName';

            const options = {
                margin: [10, 10, 10, 10],
                filename: fileName,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: {
                    scale: 2,
                    useCORS: true,
                    letterRendering: true,
                    logging: false
                },
                jsPDF: {
                    unit: 'mm',
                    format: 'a4',
                    orientation: 'portrait'
                },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
            };

            html2pdf().set(options).from(element).save().then(function() {
                setTimeout(function() {
                    window.history.back();
                }, 1000);
            });
        }

        @if (ViewBag.AutoPrint == true)
        {
            <text>
            window.onload = function() {
                setTimeout(function() {
                    downloadPDF();
                }, 500);
            };
            </text>
        }
    </script>
</body>
</html>
